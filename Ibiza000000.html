<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
  <script type="module">
     import { ModelViewerElement } from 'https://cdn.jsdelivr.net/npm/@google/model-viewer@latest/dist/model-viewer.js';
    customElements.define('model-viewer', ModelViewerElement);
    // Function to get query parameters
    function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
      const results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    // Function to detect the OS and redirect
    function detectOSAndRedirect() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      const color = getParameterByName('color');
      const image = getParameterByName('image');
      const extension = getParameterByName('extension') || '.gltf';
      const modelUrl = `https://aymengad.github.io/Ibiza000000.gltf`;

      let url = '';

      if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        url = `https://aymengad.github.io/Ibiza000000.usdz`;
      } else if (/Android/.test(userAgent)) {
        arMode = 'webxr';
      } else {
         arMode = 'webxr'; // Default
      }

            document.querySelector('model-viewer').setAttribute('src', modelUrl);
      document.querySelector('model-viewer').setAttribute('ar', '');
      document.querySelector('model-viewer').setAttribute('ar-modes', arMode);
    }

    // Run the redirection function on page load
    window.onload = detectOSAndUpdateModel;
  </script>
</head>
<body>
  <model-viewer
    alt="3D model"
    auto-rotate
    camera-controls
    style="width: 100%; height: 100%;"
  >
  </model-viewer>
</body>
</html>
